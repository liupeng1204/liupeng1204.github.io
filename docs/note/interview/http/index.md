## http

::: details 网络协议对应层级
![img](/img/network-protocol.png)
:::

::: details HTTPS与HTTP的一些区别
>1.HTTPS协议需要到CA申请证书，一般免费证书很少，需要交费。  
>2.HTTP协议运行在TCP之上，所有传输的内容都是明文，HTTPS运行在SSL/TLS之上，SSL/TLS运行在TCP之上，所有传输的内容都经过加密的。  
>3.HTTP和HTTPS使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。  
>4.HTTPS可以有效的防止运营商劫持，解决了防劫持的一个大问题。 

:::

::: details HTTP2.0和HTTP1.X相比的新特性
>1.**新的二进制格式**（Binary Format），HTTP1.x的解析是基于文本。基于文本协议的格式解析存在天然缺陷，文本的表现形式有多样性，要做到健壮性考虑的场景必然很多，二进制则不同，只认0和1的组合。基于这种考虑HTTP2.0的协议解析决定采用二进制格式，实现方便且健壮。  
>2.**多路复用**（MultiPlexing），即连接共享，即每一个request都是是用作连接共享机制的。一个request对应一个id，这样一个连接上可以有多个request，每个连接的request可以随机的混杂在一起，接收方可以根据request的 id将request再归属到各自不同的服务端请求里面。  
>3.**header压缩**，如上文中所言，对前面提到过HTTP1.x的header带有大量信息，而且每次都要重复发送，HTTP2.0使用encoder来减少需要传输的header大小，通讯双方各自cache一份header fields表，既避免了重复header的传输，又减小了需要传输的大小。  
>4.**服务端推送**（server push），同SPDY一样，HTTP2.0也具有server push功能。  

:::

::: details 网页输入一个URL到渲染的过程
```js 
① 获取IP地址
   1.首先会在浏览器的缓存中查找，是否缓存了URL，如果有，就直接向该URL对应的服务器发送请求；如果没有则进行下一步;
   2.在本地的hosts文件中是否保存了该URL和其对应的IP地址，如果保存了，就直接向该URL对应的服务器发送请求；如果没有则进行下一步；
   3.向本地DNS服务器（一般由本地网络接入服务器提供商提供，比如移动）发送DNS请求，本地DNS服务器会首先查询它的缓存记录，如果有就将该域名对应的IP地址返回给用户，如果没有则进行下一步；
   首先向根域名服务器发送DNS查询请求，根域名服务器返回给可能保存了该域名的一级域名服务器地址；本地主机再根据返回的地址，向一级域名服务器发送DNS查询请求；...一直迭代，直到找到对应的域名存放的服务器，向其发送DNS查询请求，该域名服务器返回该域名对应的IP地址；
② 三次握手建立浏览器与服务器的tcp连接
③ 浏览器向服务器发送http请求，并获取服务器响应信息
④ 浏览器拿到HTML文件后，根据渲染规则进行渲染：
   1.解析HTML，构建DOM树
   2.解析CSS，生成CSS规则树
   3.合并DOM树和CSS规则树，生成render树
   4.布局render树
   5.绘制render数、树，即绘制页面像素信息
   6.GPU将各层合成，结果呈现在浏览器窗口中。
⑤ 四次挥手关掉tcp连接
```
:::

::: details http协议中301/302/304的区别
```text 
301 Moved Permanently 永久移动。是指请求的资源已被永久的移动到新的URL，返回信息会包括新的URL，浏览器还会自动定向到新的URL。今后任何新的请求都应该使用新的URL来代替。  
302 Found 临时移动。与301类似。但是资源只是临时被移动。客户端应该继续使用原有的URI  
304 Not Modified 未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存所访问过的资源。通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源。  
```

**什么时候会出现304**  
如果客户端发送了一个带条件的GET请求已被允许，而文档中的内容（自上次访问以来或者根据请求的条件）并没有改变，则服务器应当返回这个304状态码。即客户端和服务器端只需要传输很少的数据量来做文件的校验，如果文件没有修改过，则不需要返回全量的数据。

**301和302的区别**  
（1）字面上区别：301永久重定向 302临时重定向。  
（2）301比较常用的场景是使用域名跳转。302用来做临时跳转 （例如：未登录的用户访问用户中心重定向到登录页面）

:::

